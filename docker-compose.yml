version: '3.1'

services:
  neo4jdb:
    image: neo4j:4.4.9-community
    ports:
      - 7474:7474
      - 7687:7687
    environment:
      NEO4J_AUTH: 'neo4j/s3cr3t'
      NEO4J_apoc_export_file_enabled: 'true'
      NEO4J_apoc_import_file_enabled: 'true'
      NEO4J_apoc_import_file_use__neo4j__config: 'true'
      NEO4JLABS_PLUGINS: '["apoc"]'
    healthcheck:
      test: cypher-shell --username neo4j --password s3cr3t 'MATCH (n) RETURN COUNT(n);' # Checks if neo4j server is up and running
      interval: 10s
      timeout: 10s
      retries: 5
  guac:
    build:
      context: .
    image: guac-integration:latest
    depends_on:
      neo4jdb:
        condition: service_healthy
    
      